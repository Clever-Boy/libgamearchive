.\" t
.de TQ
.  br
.  ns
.  TP \\$1
..
.TH GAMEARCH "1" "January 2010" "Camoto" "User Commands"
.SH NAME
gamearch \- manipulate file archives used internally by many games
.SH SYNOPSIS
.B gamearch
\fIarchive\fR \fIaction\fR [\fIaction...\fR]
.SH DESCRIPTION
.\" Add any additional description here
.PP
Perform the specified \fIaction\fRs on the given \fIarchive\fR.  The actions
are performed in order (i.e. the first action specified on the command line is
performed first.)
.SH ACTIONS
.TP
\fB-l\fR, \fB--list\fR
list files in the archive
.TP
\fB-X\fR, \fB--extract-all\fR
extract all the files in the archive, saving them into the current directory
.TP
\fB-x\fR \fIfile\fR[\fB=\fIdest\fR], \fB--extract=\fR\fIfile\fR[\fB=\fIdest\fR]
extract \fIfile\fR from the archive, saving it as \fIdest\fR (or into the
current directory if \fIdest\fR is not supplied)
.TP
\fB-a\fR \fIfile\fR[\fB=\fIsource\fR], \fB--add=\fR\fIfile\fR[\fB=\fIsource\fR]
add \fIsource\fR into the archive, storing it as \fIfile\fR.  If \fIsource\fR is
not specified, \fIfile\fR is read from the current directory.  If \fIfile\fR
already exists in the archive, either the operation fails, or if \fB--force\fR
is used the file in the archive is overwritten in-place.
.TP
\fB-i\fR \fIfile\fR[\fB=\fIsource\fR]\fB:\fIhere\fR, \fB--insert=\fR\fIfile\fR[\fB=\fIsource\fR]\fB:\fIhere\fR
insert \fIsource\fR into the archive, storing it at the location currently used
by \fIhere\fR.  \fIhere\fR is moved out of the way to make room.  If
\fIsource\fR is not specified, \fIfile\fR is read from the current directory.
\fIhere\fR must already exist in the archive and can be specified by name or
index (see \fBNOTES\fR below.)  After the operation, the newly inserted file
exists in the position previously occupied by \fIhere\fR, and the original file
is moved one position down (i.e. it is now directly after the new \fIfile\fR.)
.TP
\fB-o\fR \fIfile\fB=\fInewfile\fR, \fB--overwrite=\fIfile\fB=\fInewfile\fR
replace \fIfile\fR with the data from \fInewfile\fR.  \fIfile\fR can be
specified as an index (see \fBNOTES\fR below.)  The filename inside the archive
(if any) is unchanged.
.TP
\fB-r\fR \fIfile\fB=\fInewname\fR, \fB--rename=\fIfile\fB=\fInewname\fR
change the name of \fIfile\fR to \fInewname\fR.  This can be used to move files
between folders with archives that support subdirectories.  \fIfile\fR can be
specified as an index (see \fBNOTES\fR below.)  If \fInewname\fR is specified
as an index, the file is moved to that position, pushing the rest of the files
down by one.
.TP
\fB-d\fR \fIfile\fR, \fB--delete=\fR\fIfile\fR
remove \fIfile\fR from the archive
.SH OPTIONS
.TP
\fB-t\fR, \fB--type\fR
manually specify the archive type (see \fBSUPPORTED FORMATS\fR below for a list
of valid values.)  The archive type is normally autodetected, but it needs to
be specified for a few archives which lack signatures to identify them by.)
.TP
\fB-c\fR, \fB--no-compress\fR
when using \fB--add\fR with an archive that supports compressed files, don't
compress the files.  The default is to compress files if supported by the
archive format.
.TP
\fB-f\fR, \fB--force\fR
open the archive as the given --type, even if it doesn't look like it's in
that format.
.TP
\fB-v\fR, \fB--verbose\fR
print more detail when listing files with \fB--list\fR.
.TP
\fB-s\fR, \fB--script\fR
print output suitable for parsing by a script.
.SH "SUPPORTED FORMATS"
.TS
tab(@), left, box;
c c c c c c c
l l l l l l l.
-t@Ext@Game@Names?@Dir?@Order?@Comp?
_
[grp-duke3d]@grp@Duke Nukem 3D@yes@no@no@no
.TE
.PP
-t: type when specifying manually.  Values enclosed by [] can be autodetected,
other values need to be given when working with archives of that type.
.br
Names: yes, if the archive supports filenames
.br
Dir: yes, if the archive supports subdirectories
.br
Order: yes, if the order of files is important
.br
Comp: yes, if the archive supports compression
.SH "FORMATS UNDER DEVELOPMENT"
.P
.TS
tab(@), left, box;
c c c c c c c
l l l l l l l.
-t@Ext@Game@Names?@Dir?@Order?@Comp?
_
\fBrff-blood\fR@rff@Blood 1@yes@no@no@no
[wad-doom]@wad@Doom@yes@no@yes@no
\fBdat-got\fR@dat@God of Thunder@no@no@yes@?
[0-harry]@-0@Halloween Harry/Alien Carnage@yes@no@no@Alien Carnage only
\fBdat-bash\fR@dat@Monster Bash@yes@no@no@yes
[rez-shogo]@rez@Shogo/Blood 2@yes@yes@no@no
\fBlbr-vinyl\fR@lbr@Vinyl Goddess from Mars@no@no@yes@no
\fBdat-wacky\fR@dat@Wacky Wheels@yes@no@no@no
.TE
.PP
.SH "BASIC EXAMPLES"
.TP
\fBgamearch duke3d.grp --list\fR
display all the filenames inside the Duke Nukem 3D group file
.TP
\fBgamearch duke3d.grp --extract-all\fR
extract all the files inside duke3d.grp into the current directory
.TP
\fBgamearch wacky.dat --type=dat-wacky --extract-all\fR
extract the contents of \fBwacky.dat\fR.  Since the Wacky Wheels archive format
lacks a signature, it can't be autodetected so the archive type must be
specified with the \fB--type\fR parameter.  (See \fBSUPPORTED FORMATS\fR above
for a list of formats which need to be specified like this.)
.TP
\fBgamearch duke3d.grp --extract=subway.voc\fR
extract a sound effect into the current directory
.TP
\fBgamearch duke3d.grp --add=newsong.mid\fR
add a new music track into the group file
.TP
\fBgamearch duke3d.grp --delete=newsong.mid\fR
delete the file added in the last example
.SH "ADVANCED EXAMPLES"
.TP
\fBgamearch hocus.dat -x @1=first.bin\fR
extract the first file in the archive and save it as \fBfirst.bin\fR in the
current directory
.TP
\fBgamearch duke3d.grp -f -a subway.voc=/tmp/truck.voc\fR
add \fB/tmp/truck.voc\fR into the archive, saving it over the top of
\fBsubway.voc\fR
.TP
\fBgamearch duke3d.grp -x @1.5=hidden.bin\fR
extract the hidden data stored between the first and second files in the
archive (only valid if \fB--list\fR reports hidden data present)
.TP
\fBgamearch duke3d.grp -a @1.5=hidden.bin\fR
add hidden data between the first and second files in the
archive (not all archive formats support this)
.TP
\fBgamearch duke3d.grp -a music/newsong.mid\fR
.TQ
\fBgamearch duke3d.grp -a newsong.mid=music/newsong.mid\fR
the first line fails adding the file, because the .GRP format does not support
subdirectories.  The second line works as it is specifying a valid alternate
name to store in the archive.
.TP
\fBgamearch disk.pod -a music/tame.mod\fR
adds a file called \fBtame.mod\fR into the \fBmusic\fR subdirectory in the
archive \fBdisk.pod\fR.  The file being added (\fBtame.mod\fR) must also reside
in a folder called \fBmusic\fR in the current directory.
.TP
\fBgamearch disk.pod -a music/tame.mod=tame.mod\fR
same as previous example, except the file being added is now read from the
current directory instead
.TP
\fBgamearch duke3d.grp -r e1l1.map=@1\fR
moves \fBe1l1.map\fR to be the first file in the archive.  The other files are
shifted out of the way (so the original first file in the archive becomes the
second file.)  This is usually only necessary when a game places significance
on the positions of files as well as their names (e.g. .wad)
.TP
\fBgamearch duke3d.grp -a data.bin -r data.bin=@5\fR
inserts \fBdata.bin\fR as the fifth file in the archive, moving the other files
out of the way (but not overwriting any of them!)
.TP
\fBgamearch duke3d.grp -f -a @5=data.bin\fR
overwrites the fifth file in the archive with \fBdata.bin\fR (renaming the
fifth file to "data.bin" in the process, regardless of its previous name.)
.SH NOTES
.PP
When a filename refers to an item inside an archive, it can be specified either
by filename, or by index.  When using an index, prepend an at-sign (@) before
the number.  Using an index is most useful for archives which don't support
filenames, or for accessing hidden data between files in archives which
support it.
.PP
Exit status is 0 on success, 1 on failure.
.SH KNOWN ISSUES
.PP
Filenames can't (always) contain equal signs or colons, as these are interpreted
by the command-line parsing code.  It's not really worth adding code to handle
this when there will probably never be a case where it can't be worked around.
.SH AUTHOR
Written by Adam Nielsen <malvineous@shikadi.net>.
.SH "REPORTING BUGS"
Report bugs to <malvineous@shikadi.net>.
.SH COPYRIGHT
Copyright \(co 2010 Adam Nielsen.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
.br
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
.SH "SEE ALSO"
\fBfile\fR(1), <http://www.shikadi.net/camoto>
.PP
All the archive formats supported by this utility are fully documented on the Game Modding
Wiki \fB<http://www.shikadi.net/moddingwiki>\fR.
.PP
This utility is part of the Camoto suite of tools.
